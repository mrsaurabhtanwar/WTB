[phases.setup]
nixPkgs = ["nodejs", "npm", "chromium", "nss", "freetype", "harfbuzz", "ca-certificates", "ttf-freefont"]

[phases.build]
cmds = ["npm ci --only=production"]

[phases.start]
cmd = "npm start"

[variables]
NODE_ENV = "production"
NIXPACKS_NO_CACHE = "1"
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD = "true"
PUPPETEER_EXECUTABLE_PATH = "/nix/store/*/bin/chromium"